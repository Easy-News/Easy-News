FROM openjdk:17-jdk

# 빌드 시 전달된 JAR_FILE 경로를 ARG로 받음
ARG JAR_FILE=../../build/libs/*.jar
ARG GPT_API_KEY
ARG GPT_API_URL
ARG MAIL_ADDRESS
ARG MAIL_PASSWORD
ARG MYSQL_PASSWORD
ARG MYSQL_URL
ARG MYSQL_USER

# JAR_FILE을 컨테이너 내부의 app.jar로 복사
COPY ${JAR_FILE} main-module.jar

ENV GPT_API_KEY=${GPT_API_KEY}
ENV GPT_API_URL=${GPT_API_URL}
ENV MAIL_ADDRESS=${MAIL_ADDRESS}
ENV MAIL_PASSWORD=${MAIL_PASSWORD}
ENV MYSQL_PASSWORD=${MYSQL_PASSWORD}
ENV MYSQL_URL=${MYSQL_URL}
ENV MYSQL_USER=${MYSQL_USER}

# 애플리케이션 실행
ENTRYPOINT ["java", "-jar", "/main-module.jar"]