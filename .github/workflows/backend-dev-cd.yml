name: Java CD with Gradle

on:
  push:
    branches: [ "baePoYong" ]

jobs:
  test-login:
    runs-on: ubuntu-latest
    steps:
      - name: '1. Check if Secrets are Accessible'
        run: |
          # Secret이 비어있는지 먼저 확인합니다.
          if [ -z "${{ secrets.DOCKER_USERNAME }}" ]; then
            echo "ERROR: DOCKER_USERNAME secret is not set or empty."
            exit 1
          fi
          if [ -z "${{ secrets.DOCKER_PASSWORD }}" ]; then
            echo "ERROR: DOCKER_PASSWORD secret is not set or empty."
            exit 1
          fi
          echo "✅ Secrets are present. Proceeding to login..."
          echo "Attempting to log in as user: ${{ secrets.DOCKER_USERNAME }}"

      - name: '2. Login to Docker Hub'
        # 가장 표준적이고 안정적인 Docker 공식 로그인 액션을 사용합니다.
        uses: docker/login-action@v3
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      - name: '3. Success Message'
        run: echo "🎉 Docker Hub login was successful! The credentials are correct."